SELECT timestamp,
    id,
    body_json,
    body_json_promoted
FROM signoz_logs.distributed_logs_v2
WHERE (
        arrayExists(
            `body_json.customer.profile`->(
                dynamicElement(`body_json.customer.profile`.header, 'String') != ''
                OR dynamicElement(
                    `body_json.customer.profile`.header,
                    'Array(Nullable(String))'
                ) != []
            ),
            dynamicElement(
                body_json.customer.profile,
                'Array(JSON(max_dynamic_types=16, max_dynamic_paths=0))'
            )
        )
    );
SELECT timestamp,
    id,
    body_json,
    body_json_promoted
FROM signoz_logs.distributed_logs_v2
WHERE (
        arrayExists(
            `body_json.customer.profile`->(
                length(
                    dynamicElement(
                        `body_json.customer.profile`.header,
                        'Array(Nullable(Float64))'
                    )
                ) > 0
            ),
            dynamicElement(
                body_json.customer.profile,
                'Array(JSON(max_dynamic_types=16, max_dynamic_paths=0))'
            )
        )
    );
SELECT timestamp,
    id,
    trace_id,
    span_id,
    trace_flags,
    severity_text,
    severity_number,
    scope_name,
    scope_version,
    body,
    body_json,
    body_json_promoted,
    attributes_string,
    attributes_number,
    attributes_bool,
    resources_string,
    scope_string
FROM signoz_logs.distributed_logs_v2
WHERE (
        arrayExists(
            `body_json.customer.profile`->arrayExists(
                x->x = '200',
                dynamicElement(
                    `body_json.customer.profile`.header,
                    'Array(Nullable(String))'
                )
            ),
            dynamicElement(
                body_json.customer.profile,
                'Array(JSON(max_dynamic_types=16, max_dynamic_paths=0))'
            )
        )
    );
SELECT timestamp,
    id,
    trace_id,
    span_id,
    trace_flags,
    severity_text,
    severity_number,
    scope_name,
    scope_version,
    body,
    body_json,
    body_json_promoted,
    attributes_string,
    attributes_number,
    attributes_bool,
    resources_string,
    scope_string
FROM signoz_logs.distributed_logs_v2
WHERE (
        arrayExists(
            `body_json.customer.profile`->arrayExists(
                x->x = '200',
                dynamicElement(
                    `body_json.customer.profile`.header,
                    'Array(Nullable(String))'
                )
            ),
            dynamicElement(
                body_json.customer.profile,
                'Array(JSON(max_dynamic_types=16, max_dynamic_paths=0))'
            )
        )
    )
    OR (
        arrayExists(
            `body_json.customer.profile`->dynamicElement(
                `body_json.customer.profile`.header,
                'String'
            ) = '403',
            dynamicElement(
                body_json.customer.profile,
                'Array(JSON(max_dynamic_types=16, max_dynamic_paths=0))'
            )
        )
    );
Explain SELECT timestamp,
    id,
    trace_id,
    span_id,
    trace_flags,
    severity_text,
    severity_number,
    scope_name,
    scope_version,
    body,
    body_json,
    body_json_promoted,
    attributes_string,
    attributes_number,
    attributes_bool,
    resources_string,
    scope_string
FROM signoz_logs.distributed_logs_v2
WHERE (
        arrayExists(
            `body_json.customer.profile`->arrayExists(
                x->x = '200',
                dynamicElement(
                    `body_json.customer.profile`.header,
                    'Array(Nullable(String))'
                )
            )
            OR dynamicElement(
                `body_json.customer.profile`.header,
                'String'
            ) = '403',
            dynamicElement(
                body_json.customer.profile,
                'Array(JSON(max_dynamic_types=16, max_dynamic_paths=0))'
            )
        )
    );
SELECT timestamp,
    id,
    trace_id,
    span_id,
    trace_flags,
    severity_text,
    severity_number,
    scope_name,
    scope_version,
    body,
    body_json,
    body_json_promoted,
    attributes_string,
    attributes_number,
    attributes_bool,
    resources_string,
    scope_string
FROM signoz_logs.distributed_logs_v2
WHERE (
        arrayExists(
            `body_json.cache.persistence.retrieve`->dynamicElement(
                `body_json.cache.persistence.retrieve`.settings,
                'String'
            ) = '503',
            dynamicElement(
                body_json.cache.persistence.retrieve,
                'Array(JSON(max_dynamic_types=16, max_dynamic_paths=0))'
            )
        )
    );